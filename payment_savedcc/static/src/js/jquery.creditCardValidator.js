(function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};e=jQuery;e.fn.validateCreditCard=function(n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m;o=[{name:"amex",pattern:/^3[47]/,valid_length:[15]},{name:"diners_club_carte_blanche",pattern:/^30[0-5]/,valid_length:[14]},{name:"diners_club_international",pattern:/^36/,valid_length:[14]},{name:"jcb",pattern:/^35(2[89]|[3-8][0-9])/,valid_length:[16]},{name:"laser",pattern:/^(6304|670[69]|6771)/,valid_length:[16,17,18,19]},{name:"visa_electron",pattern:/^(4026|417500|4508|4844|491(3|7))/,valid_length:[16]},{name:"visa",pattern:/^4/,valid_length:[16]},{name:"mastercard",pattern:/^5[1-5]/,valid_length:[16]},{name:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,valid_length:[12,13,14,15,16,17,18,19]},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,valid_length:[16]}];if(r==null){r={}}if((v=r.accept)==null){r.accept=function(){var e,t,n;n=[];for(e=0,t=o.length;e<t;e++){i=o[e];n.push(i.name)}return n}()}m=r.accept;for(p=0,d=m.length;p<d;p++){s=m[p];if(t.call(function(){var e,t,n;n=[];for(e=0,t=o.length;e<t;e++){i=o[e];n.push(i.name)}return n}(),s)<0){throw"Credit card type '"+s+"' is not supported"}}u=function(e){var n,u,a;a=function(){var e,n,s,u;u=[];for(e=0,n=o.length;e<n;e++){i=o[e];if(s=i.name,t.call(r.accept,s)>=0){u.push(i)}}return u}();for(n=0,u=a.length;n<u;n++){s=a[n];if(e.match(s.pattern)){return s}}return null};f=function(e){var t,n,r,i,s,o;r=0;o=e.split("").reverse();for(n=i=0,s=o.length;i<s;n=++i){t=o[n];t=+t;if(n%2){t*=2;if(t<10){r+=t}else{r+=t-9}}else{r+=t}}return r%10===0};a=function(e,n){var r;return r=e.length,t.call(n.valid_length,r)>=0};h=function(e){var t,r;s=u(e);r=false;t=false;if(s!=null){r=f(e);t=a(e,s)}return n({card_type:s,luhn_valid:r,length_valid:t})};c=function(){var t;t=l(e(this).val());return h(t)};l=function(e){return e.replace(/[ -]/g,"")};this.bind("input",function(){e(this).unbind("keyup");return c.call(this)});this.bind("keyup",function(){return c.call(this)});if(this.length!==0){c.call(this)}return this}}).call(this)